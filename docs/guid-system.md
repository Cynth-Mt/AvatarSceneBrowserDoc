# GUIDè¿½è¸ªç³»ç»Ÿ

## æ¦‚è¿°

GUIDè¿½è¸ªç³»ç»Ÿæ˜¯Avatar Scene Browseræ’ä»¶çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒè§£å†³äº†ä¼ ç»ŸåŸºäºæ–‡ä»¶è·¯å¾„çš„åœºæ™¯ç®¡ç†ç³»ç»Ÿçš„æ ¹æœ¬é—®é¢˜ã€‚é€šè¿‡ä½¿ç”¨Unityå†…éƒ¨çš„GUIDï¼ˆå…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼‰æ¥è¿½è¸ªåœºæ™¯æ–‡ä»¶ï¼Œå³ä½¿åœºæ™¯è¢«é‡å‘½åæˆ–ç§»åŠ¨ï¼Œæ’ä»¶ä¾ç„¶èƒ½å¤Ÿæ­£ç¡®ç»´æŠ¤æ‰€æœ‰ç›¸å…³æ•°æ®ã€‚

## é—®é¢˜èƒŒæ™¯

### ä¼ ç»Ÿè·¯å¾„è¿½è¸ªçš„é—®é¢˜

åœ¨å‡çº§åˆ°GUIDç³»ç»Ÿä¹‹å‰ï¼ŒAvatar Scene Browserä½¿ç”¨æ–‡ä»¶è·¯å¾„æ¥è¯†åˆ«å’Œç®¡ç†åœºæ™¯ï¼š

**ä¸»è¦é—®é¢˜ï¼š**
- ğŸš« **æ•°æ®ä¸¢å¤±é£é™©**ï¼šå½“ç”¨æˆ·é‡å‘½åSceneæ–‡ä»¶æ—¶ï¼ŒåŸæœ‰æ•°æ®ä¼šä¸¢å¤±
- ğŸš« **è·¯å¾„ä¾èµ–**ï¼šç³»ç»Ÿå®Œå…¨ä¾èµ–æ–‡ä»¶è·¯å¾„ï¼Œç§»åŠ¨æ–‡ä»¶ä¼šå¯¼è‡´å¼•ç”¨å¤±æ•ˆ
- ğŸš« **ä¸ç¨³å®šæ€§**ï¼šæ–‡ä»¶ç³»ç»Ÿæ“ä½œå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´

**å…¸å‹é—®é¢˜åœºæ™¯ï¼š**
```
ç”¨æˆ·æ“ä½œæµç¨‹ï¼š
1. ä¸ºScene "MyAvatar.unity" æ·»åŠ äº†æ ‡ç­¾å’Œæˆªå›¾
2. é‡å‘½åæ–‡ä»¶ä¸º "MyNewAvatar.unity"  
3. ç»“æœï¼šæ‰€æœ‰ç›¸å…³æ•°æ®ä¸¢å¤±ï¼Œéœ€è¦é‡æ–°è®¾ç½®
```

## GUIDç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ

### æ ¸å¿ƒåŸç†

Unityä¸ºæ¯ä¸ªèµ„æºæ–‡ä»¶åˆ†é…ä¸€ä¸ªæ°¸ä¹…çš„GUIDï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š
- **æ°¸ä¹…æ€§**ï¼šæ–‡ä»¶åˆ›å»ºæ—¶ç”Ÿæˆï¼Œç»ˆç”Ÿä¸å˜
- **å”¯ä¸€æ€§**ï¼šåœ¨é¡¹ç›®ä¸­ç»å¯¹å”¯ä¸€
- **ç‹¬ç«‹æ€§**ï¼šä¸å—æ–‡ä»¶åã€è·¯å¾„å˜åŒ–å½±å“

### ç³»ç»Ÿä¼˜åŠ¿

âœ… **æ°¸ä¹…æ ‡è¯†**ï¼šUnityå†…éƒ¨ä½¿ç”¨GUIDæ°¸ä¹…æ ‡è¯†èµ„æºï¼Œä¸å—æ–‡ä»¶åå˜åŒ–å½±å“  
âœ… **è‡ªåŠ¨è¿½è¸ª**ï¼šå³ä½¿æ–‡ä»¶è¢«ç§»åŠ¨æˆ–é‡å‘½åï¼ŒGUIDä¿æŒä¸å˜  
âœ… **UnityåŸç”Ÿ**ï¼šå……åˆ†åˆ©ç”¨Unityçš„AssetDatabase API  
âœ… **å‘åå…¼å®¹**ï¼šå®Œå…¨å…¼å®¹æ—§ç‰ˆæœ¬æ•°æ®ï¼Œè‡ªåŠ¨è¿ç§»æ— éœ€æ‰‹åŠ¨æ“ä½œ  

## æŠ€æœ¯å®ç°

### æ•°æ®ç»“æ„å‡çº§

æ–°çš„åœºæ™¯æ•°æ®ç»“æ„åŒæ—¶ä¿å­˜è·¯å¾„å’ŒGUIDä¿¡æ¯ï¼š

```csharp
[Serializable]
public class SceneData
{
    public string scenePath;  // ä¿ç•™ç”¨äºå‘åå…¼å®¹
    public string sceneGUID;  // æ–°å¢çš„ä¸»è¦æ ‡è¯†ç¬¦
    public string screenshotPath;
    public List<string> tags = new List<string>();
    public bool isError = false;
    
    // æ™ºèƒ½è·¯å¾„è·å–
    public string GetCurrentScenePath()
    {
        if (!string.IsNullOrEmpty(sceneGUID))
        {
            string currentPath = AssetDatabase.GUIDToAssetPath(sceneGUID);
            if (!string.IsNullOrEmpty(currentPath))
            {
                // è‡ªåŠ¨æ›´æ–°ç¼“å­˜çš„è·¯å¾„
                if (currentPath != scenePath)
                {
                    scenePath = currentPath;
                }
                return currentPath;
            }
        }
        return scenePath; // å‘åå…¼å®¹å›é€€
    }
}
```

### æ ¸å¿ƒç®¡ç†å™¨é‡æ„

SceneDataManagerä»åŸºäºè·¯å¾„çš„å­—å…¸æ”¹ä¸ºåŸºäºGUIDçš„å­—å…¸ï¼š

```csharp
public class SceneDataManager
{
    // æ ¸å¿ƒæ”¹å˜ï¼šä»è·¯å¾„é”®æ”¹ä¸ºGUIDé”®
    private Dictionary<string, SceneData> scenesData = new Dictionary<string, SceneData>();
    
    // æ€§èƒ½ä¼˜åŒ–ï¼šè·¯å¾„åˆ°GUIDçš„æ˜ å°„ç¼“å­˜
    private Dictionary<string, string> pathToGuidCache = new Dictionary<string, string>();
}
```

### è‡ªåŠ¨æ•°æ®è¿ç§»

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶è¿ç§»æ—§ç‰ˆæœ¬æ•°æ®ï¼š

```csharp
private Dictionary<string, SceneData> MigrateSceneDataToGUID(Dictionary<string, SceneData> loadedData)
{
    Dictionary<string, SceneData> migratedData = new Dictionary<string, SceneData>();
    
    foreach (var kvp in loadedData)
    {
        SceneData sceneData = kvp.Value;
        
        // å¦‚æœå·²ç»æœ‰GUIDï¼Œç›´æ¥ä½¿ç”¨
        if (!string.IsNullOrEmpty(sceneData.sceneGUID))
        {
            migratedData[sceneData.sceneGUID] = sceneData;
            continue;
        }
        
        // è‡ªåŠ¨è·å–GUIDå¹¶è¿ç§»
        string guid = AssetDatabase.AssetPathToGUID(sceneData.scenePath);
        if (!string.IsNullOrEmpty(guid))
        {
            sceneData.sceneGUID = guid;
            migratedData[guid] = sceneData;
        }
    }
    
    return migratedData;
}
```

## ç³»ç»Ÿç‰¹æ€§

### 1. å‘åå…¼å®¹æ€§
- âœ… å®Œå…¨å…¼å®¹æ—§ç‰ˆæœ¬æ•°æ®æ–‡ä»¶
- âœ… è‡ªåŠ¨è¿ç§»æœºåˆ¶ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨æ“ä½œ
- âœ… ä¿ç•™åŸæœ‰APIæ¥å£ï¼Œç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹

### 2. æ™ºèƒ½è¿½è¸ª
- âœ… æ–‡ä»¶é‡å‘½ååè‡ªåŠ¨æ›´æ–°è·¯å¾„
- âœ… æ–‡ä»¶ç§»åŠ¨åè‡ªåŠ¨è¿½è¸ªæ–°ä½ç½®
- âœ… æ™ºèƒ½é”™è¯¯æ£€æµ‹å’Œæ¢å¤

### 3. æ€§èƒ½ä¼˜åŒ–
- âœ… è·¯å¾„åˆ°GUIDçš„æ˜ å°„ç¼“å­˜
- âœ… å‡å°‘AssetDatabaseæŸ¥è¯¢æ¬¡æ•°
- âœ… æ›´é«˜æ•ˆçš„æ•°æ®æŸ¥æ‰¾

### 4. å¢å¼ºAPI

æ–°å¢çš„æ–¹æ³•è®©å¼€å‘æ›´åŠ ä¾¿åˆ©ï¼š

```csharp
// æ–°å¢æ–¹æ³•
public SceneData GetSceneDataByGUID(string sceneGUID)
public bool RemoveSceneDataByGUID(string sceneGUID)

// å¢å¼ºçš„ç°æœ‰æ–¹æ³•
public string GetCurrentScenePath() // SceneDataç±»ä¸­
public bool IsSceneValid()          // SceneDataç±»ä¸­
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨ï¼ˆç”¨æˆ·æ— æ„ŸçŸ¥ï¼‰

å¯¹äºæ™®é€šç”¨æˆ·ï¼Œå‡çº§å®Œå…¨é€æ˜ï¼š

```csharp
// ç”¨æˆ·ä»£ç ä¿æŒä¸å˜
SceneDataManager manager = new SceneDataManager(tagManager);
SceneData data = manager.GetSceneData("Assets/MyScene.unity");

// å†…éƒ¨è‡ªåŠ¨ä½¿ç”¨GUIDè¿½è¸ª
```

### é«˜çº§ä½¿ç”¨

å¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨GUIDè¿›è¡Œæ“ä½œï¼š

```csharp
// ç›´æ¥ä½¿ç”¨GUIDæ“ä½œï¼ˆæ¨èï¼‰
string sceneGUID = AssetDatabase.AssetPathToGUID(scenePath);
SceneData data = manager.GetSceneDataByGUID(sceneGUID);

// æ™ºèƒ½è·¯å¾„è·å–
string currentPath = data.GetCurrentScenePath(); // è‡ªåŠ¨æ›´æ–°è·¯å¾„

// åœºæ™¯æœ‰æ•ˆæ€§æ£€æŸ¥
bool isValid = data.IsSceneValid(); // åŸºäºGUIDéªŒè¯
```

## Unity GUIDç³»ç»ŸæŠ€æœ¯ç»†èŠ‚

### GUIDç‰¹æ€§
```csharp
// GUIDè·å–
string guid = AssetDatabase.AssetPathToGUID(path);

// è·¯å¾„è·å–  
string path = AssetDatabase.GUIDToAssetPath(guid);

// GUIDç‰¹æ€§è¯´æ˜ï¼š
// - 32å­—ç¬¦åå…­è¿›åˆ¶å­—ç¬¦ä¸²
// - å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦
// - ä¸å—æ–‡ä»¶åå’Œè·¯å¾„å˜åŒ–å½±å“
// - Unityé¡¹ç›®é—´å¯èƒ½ä¸åŒ
```

### æ•°æ®å­˜å‚¨æ ¼å¼

æ–°çš„JSONå­˜å‚¨æ ¼å¼åŒæ—¶åŒ…å«è·¯å¾„å’ŒGUIDï¼š

```json
{
  "scenes": [
    {
      "scenePath": "Assets/MyScene.unity",
      "sceneGUID": "a1b2c3d4e5f6789012345678901234567890abcd",
      "screenshotPath": "Assets/Screenshots/MyScene.png",
      "tags": ["Character", "Indoor"]
    }
  ]
}
```

## å‡çº§å½±å“

### å¯¹ç”¨æˆ·çš„å½±å“
- âœ… **é›¶å½±å“**ï¼šå‡çº§è¿‡ç¨‹å®Œå…¨è‡ªåŠ¨åŒ–
- âœ… **æ›´ç¨³å®š**ï¼šä¸å†æ‹…å¿ƒé‡å‘½åæ–‡ä»¶å¯¼è‡´æ•°æ®ä¸¢å¤±
- âœ… **æ›´å¯é **ï¼šç³»ç»Ÿèƒ½è‡ªåŠ¨é€‚åº”æ–‡ä»¶ç³»ç»Ÿå˜åŒ–

### å¯¹å¼€å‘è€…çš„å½±å“
- âœ… **æ›´æ¸…æ™°çš„æ¶æ„**ï¼šåŸºäºGUIDçš„è®¾è®¡æ›´ç¬¦åˆUnityæœ€ä½³å®è·µ
- âœ… **æ›´å¥½çš„æ‰©å±•æ€§**ï¼šä¸ºæœªæ¥åŠŸèƒ½æ‰©å±•å¥ å®šåŸºç¡€
- âœ… **æ›´å®¹æ˜“ç»´æŠ¤**ï¼šå‡å°‘è·¯å¾„ç›¸å…³çš„é”™è¯¯å¤„ç†

## æœ€ä½³å®è·µ

### æ•°æ®ç®¡ç†å»ºè®®
1. **å®šæœŸæ£€æŸ¥**ï¼šä½¿ç”¨[GUIDæ‰¹é‡æ›´æ–°å·¥å…·](guid-batch-tool.md)å®šæœŸæ£€æŸ¥æ•°æ®å®Œæ•´æ€§
2. **å¤‡ä»½é‡è¦æ•°æ®**ï¼šåœ¨é‡å¤§æ“ä½œå‰å¤‡ä»½`scenes_data.json`æ–‡ä»¶
3. **å›¢é˜Ÿåä½œ**ï¼šç¡®ä¿å›¢é˜Ÿæˆå‘˜éƒ½ä½¿ç”¨æ”¯æŒGUIDç³»ç»Ÿçš„æ’ä»¶ç‰ˆæœ¬

### æ•…éšœæ’é™¤
å¦‚æœé‡åˆ°GUIDç›¸å…³é—®é¢˜ï¼š
1. ä½¿ç”¨GUIDæ‰¹é‡æ›´æ–°å·¥å…·æ£€æŸ¥å’Œä¿®å¤
2. æ£€æŸ¥Unityæ§åˆ¶å°æ˜¯å¦æœ‰ç›¸å…³é”™è¯¯ä¿¡æ¯
3. ç¡®ä¿åœºæ™¯æ–‡ä»¶æ²¡æœ‰è¢«å¤–éƒ¨ç¨‹åºä¿®æ”¹

## æ€»ç»“

GUIDè¿½è¸ªç³»ç»Ÿæ˜¯Avatar Scene Browseræ’ä»¶çš„é‡å¤§æŠ€æœ¯å‡çº§ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†æ–‡ä»¶é‡å‘½åå’Œç§»åŠ¨å¯¼è‡´çš„æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚è¿™ä¸ªå‡çº§ï¼š

### ä¸»è¦æ”¶ç›Š
1. **æ•°æ®å®‰å…¨æ€§**ï¼šå½»åº•è§£å†³æ•°æ®ä¸¢å¤±é—®é¢˜
2. **ç”¨æˆ·ä½“éªŒ**ï¼šæ— éœ€æ‹…å¿ƒæ–‡ä»¶æ“ä½œå½±å“æ•°æ®
3. **ç³»ç»Ÿç¨³å®šæ€§**ï¼šåŸºäºUnityåŸç”ŸGUIDç³»ç»Ÿ
4. **å‘åå…¼å®¹**ï¼šæ— ç¼å‡çº§ï¼Œä¸å½±å“ç°æœ‰ç”¨æˆ·
5. **æŠ€æœ¯å…ˆè¿›æ€§**ï¼šç¬¦åˆUnityæœ€ä½³å®è·µ

è¿™ä¸ªå‡çº§ä¸ºAvatar Scene Browseræ’ä»¶çš„é•¿æœŸå‘å±•å¥ å®šäº†åšå®çš„æŠ€æœ¯åŸºç¡€ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ›´åŠ æ”¾å¿ƒåœ°ç®¡ç†å’Œç»„ç»‡Unityé¡¹ç›®ä¸­çš„åœºæ™¯èµ„æºã€‚ 